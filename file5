changes from M1 branch
